# Moonshot API 集成说明

## 概述

本项目已成功集成 Moonshot Kimi K2 大模型，可以使用真实的AI来生成高质量的结构化提示词。

## 功能特性

### ✨ 真实AI生成
- 使用 Moonshot Kimi K2 模型进行提示词生成
- 支持14种专业AI沟通模型框架
- 智能参数调节（创意度、专业度、详细度等）

### 🔄 智能回退机制
- API调用失败时自动回退到本地生成
- 确保服务的高可用性
- 用户体验无缝切换

### 📊 实时状态监控
- 页面顶部显示API连接状态
- 生成按钮下方提示当前使用的生成方式
- 连接状态实时检测

## 配置说明

### 环境变量配置

1. 复制 `.env.example` 为 `.env.local`
2. 填入你的API配置：

```env
VITE_MOONSHOT_API_KEY=your_api_key_here
VITE_MOONSHOT_BASE_URL=https://api.moonshot.cn/v1
VITE_MOONSHOT_MODEL=kimi-k2-0711-preview
```

### API Key 获取

1. 访问 [Moonshot AI 官网](https://platform.moonshot.cn/)
2. 注册账号并获取API Key
3. 将API Key填入环境变量文件

## 使用方法

### 1. 基础使用

1. 在"需求设想"区域输入你的需求描述
2. 选择合适的AI沟通模型（或使用智能匹配）
3. 调整生成参数（可选）
4. 点击"生成结构化提示词"按钮

### 2. 智能匹配

1. 输入需求描述后，点击"智能匹配模型"按钮
2. 系统会自动推荐最适合的模型
3. 查看推荐理由并确认选择
4. 生成专业的结构化提示词

### 3. 高级设置

- **创意度**：控制生成内容的创新程度
- **专业度**：调整输出的专业水平
- **详细度**：设置内容的详细程度
- **模型权重**：影响模型框架的严格程度

## 技术架构

### 核心组件

- `src/services/moonshot.ts` - Moonshot API服务模块
- `src/store/index.ts` - 状态管理和生成逻辑
- `src/pages/Generate.tsx` - 主要生成页面

### API集成流程

1. **输入处理** - 用户输入需求和参数
2. **Prompt构建** - 根据选择的模型构建专业提示词
3. **API调用** - 调用Moonshot API生成内容
4. **结果处理** - 格式化并展示生成结果
5. **错误处理** - 失败时回退到本地生成

## 状态指示器

### 连接状态
- 🟢 **API已连接** - 使用真实AI生成
- 🔴 **API未连接** - 使用本地模拟生成

### 生成状态
- ✨ **使用Kimi K2大模型生成** - 真实AI生成中
- ⚠️ **API未连接，使用本地模拟生成** - 回退模式

## 故障排除

### 常见问题

1. **API连接失败**
   - 检查API Key是否正确
   - 确认网络连接正常
   - 验证API额度是否充足

2. **生成失败**
   - 系统会自动回退到本地生成
   - 检查控制台错误信息
   - 尝试重新生成

3. **环境变量不生效**
   - 确保文件名为 `.env.local`
   - 重启开发服务器
   - 检查变量名前缀 `VITE_`

## 安全注意事项

- ✅ API Key存储在环境变量中
- ✅ `.env.local` 已被gitignore忽略
- ✅ 不会将敏感信息提交到版本控制
- ⚠️ 生产环境请使用服务器端代理调用API

## 更新日志

### v1.0.0 (当前版本)
- ✅ 集成Moonshot Kimi K2 API
- ✅ 实现智能回退机制
- ✅ 添加实时状态监控
- ✅ 支持环境变量配置
- ✅ 完善错误处理机制

---

如有问题，请检查控制台日志或联系开发团队。